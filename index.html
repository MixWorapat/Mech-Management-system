<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PEA Job Management</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <?!= include('css'); ?>
</head>
<body class="bg-slate-50 text-slate-800 h-screen flex overflow-hidden selection:bg-indigo-100 selection:text-indigo-700">

  <!-- LOGIN SECTION -->
  <div id="login-section" class="fixed inset-0 z-50 flex items-center justify-center bg-slate-100 transition-opacity duration-500">
    <div class="absolute inset-0 overflow-hidden"><div class="absolute -top-[20%] -left-[10%] w-[50%] h-[50%] rounded-full bg-indigo-200/30 blur-3xl"></div><div class="absolute top-[60%] -right-[10%] w-[40%] h-[40%] rounded-full bg-blue-200/30 blur-3xl"></div></div>
    <div class="bg-white/80 backdrop-blur-xl p-10 rounded-2xl shadow-xl w-full max-w-md border border-white/50 relative z-10">
      <div class="text-center mb-8"><div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl flex items-center justify-center mx-auto mb-5 shadow-lg shadow-indigo-200"><i class="fa-solid fa-bolt text-3xl text-white"></i></div><h1 class="text-2xl font-bold text-slate-800 tracking-tight">ระบบบริหารงานเครื่องกล</h1></div>
      <form id="login-form" onsubmit="handleLogin(event)" class="space-y-5">
        <div><label class="block text-sm font-semibold text-slate-600 mb-1.5">รหัสพนักงาน</label><div class="relative group"><span class="absolute inset-y-0 left-0 flex items-center pl-3.5 text-slate-400"><i class="fa-solid fa-id-badge"></i></span><input type="text" id="username" class="w-full pl-10 pr-4 py-3 rounded-lg bg-slate-50 border border-slate-200 focus:bg-white focus:border-indigo-500 outline-none transition font-num" required placeholder="Employee ID"></div></div>
        <div><label class="block text-sm font-semibold text-slate-600 mb-1.5">รหัสผ่าน</label><div class="relative group"><span class="absolute inset-y-0 left-0 flex items-center pl-3.5 text-slate-400"><i class="fa-solid fa-lock"></i></span><input type="password" id="password" class="w-full pl-10 pr-4 py-3 rounded-lg bg-slate-50 border border-slate-200 focus:bg-white focus:border-indigo-500 outline-none transition font-num" required placeholder="••••••••"></div></div>
        <div class="flex items-center justify-between mt-2"><label class="flex items-center text-sm text-slate-600 cursor-pointer"><input type="checkbox" id="remember-me" class="mr-2 w-4 h-4 rounded text-indigo-600 border-gray-300">จดจำรหัสผ่าน</label></div>
        <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-lg transition-all shadow-lg flex justify-center"><span id="login-btn-text">เข้าสู่ระบบ</span><i id="login-spinner" class="fa-solid fa-circle-notch fa-spin ml-2 hidden"></i></button>
      </form>
    </div>
  </div>

  <!-- APP CONTAINER -->
  <div id="app-container" class="hidden flex w-full h-full relative opacity-0 transition-opacity duration-500">
    <div id="mobile-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-slate-900/50 z-30 hidden md:hidden transition-opacity backdrop-blur-sm"></div>

    <!-- SIDEBAR -->
    <aside id="sidebar" class="fixed inset-y-0 left-0 z-40 w-72 bg-white border-r border-slate-100 flex flex-col shadow-2xl md:shadow-none transform -translate-x-full md:relative md:translate-x-0 transition-all duration-300 ease-in-out group/sidebar">
      <div id="sidebar-header" class="h-20 flex items-center justify-between px-5 border-b border-slate-50 shrink-0 transition-all duration-300 relative">
        <div id="sidebar-logo-group" class="flex items-center gap-3 overflow-hidden whitespace-nowrap transition-all duration-300 origin-left">
          <div class="w-10 h-10 min-w-[2.5rem] bg-indigo-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-indigo-200/50 shrink-0"><i class="fa-solid fa-bolt text-lg"></i></div>
          <div class="sidebar-text opacity-100 transition-opacity duration-200"><h1 class="font-bold text-slate-800 text-lg leading-tight">PEA Mech</h1><p class="text-[10px] text-slate-400 font-medium tracking-wide">Management System</p></div>
        </div>
        <button onclick="toggleSidebarDesktop()" id="sidebar-toggle-btn" class="hidden md:flex absolute -right-3 top-7 w-7 h-7 bg-white border border-slate-200 rounded-full items-center justify-center text-slate-400 hover:text-indigo-600 hover:border-indigo-200 shadow-sm transition-all z-50"><i id="sidebar-toggle-icon" class="fa-solid fa-chevron-left text-xs transition-transform duration-300"></i></button>
      </div>
      
      <nav class="flex-1 px-3 py-6 space-y-1.5 overflow-y-auto overflow-x-hidden scrollbar-hide">
        <button onclick="showPage('dashboard')" class="nav-item w-full flex items-center px-3.5 py-3 rounded-xl text-slate-500 hover:bg-indigo-50 hover:text-indigo-600 transition-all duration-200 group relative" title="Dashboard">
          <div class="w-6 h-6 flex items-center justify-center shrink-0"><i class="fa-solid fa-chart-pie text-lg transition-transform group-hover:scale-110"></i></div>
          <span class="sidebar-text ml-3 font-medium text-sm whitespace-nowrap">ภาพรวมระบบ</span>
          <div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">ภาพรวมระบบ</div>
        </button>
        <div class="py-3 px-1"><div class="h-px bg-slate-100 w-full mb-3 collapsed-divider hidden"></div><span class="sidebar-text text-[10px] font-bold text-slate-400 uppercase tracking-widest pl-2">จัดการงาน</span></div>
        <button onclick="filterJobPage('active', 'งานปัจจุบัน')" class="nav-item w-full flex items-center px-3.5 py-3 rounded-xl text-slate-500 hover:bg-indigo-50 hover:text-indigo-600 transition-all duration-200 group relative"><div class="w-6 h-6 flex items-center justify-center shrink-0"><i class="fa-solid fa-clock text-lg text-yellow-500"></i></div><span class="sidebar-text ml-3 font-medium text-sm whitespace-nowrap">งานปัจจุบัน</span><div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">งานปัจจุบัน</div></button>
        <button onclick="filterJobPage('pending', 'งานรออนุมัติ')" class="nav-item w-full flex items-center px-3.5 py-3 rounded-xl text-slate-500 hover:bg-indigo-50 hover:text-indigo-600 transition-all duration-200 group relative"><div class="w-6 h-6 flex items-center justify-center shrink-0"><i class="fa-solid fa-hourglass-half text-lg text-purple-500"></i></div><span class="sidebar-text ml-3 font-medium text-sm whitespace-nowrap">งานรออนุมัติ</span><div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">งานรออนุมัติ</div></button>
        <button onclick="filterJobPage('closed', 'งานเสร็จ')" class="nav-item w-full flex items-center px-3.5 py-3 rounded-xl text-slate-500 hover:bg-indigo-50 hover:text-indigo-600 transition-all duration-200 group relative"><div class="w-6 h-6 flex items-center justify-center shrink-0"><i class="fa-solid fa-circle-check text-lg text-green-500"></i></div><span class="sidebar-text ml-3 font-medium text-sm whitespace-nowrap">งานเสร็จสิ้น</span><div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">งานเสร็จสิ้น</div></button>
        <button onclick="filterJobPage('cancelled', 'งานยกเลิก')" class="nav-item w-full flex items-center px-3.5 py-3 rounded-xl text-slate-500 hover:bg-indigo-50 hover:text-indigo-600 transition-all duration-200 group relative"><div class="w-6 h-6 flex items-center justify-center shrink-0"><i class="fa-solid fa-ban text-lg text-red-500"></i></div><span class="sidebar-text ml-3 font-medium text-sm whitespace-nowrap">งานยกเลิก</span><div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">งานยกเลิก</div></button>
        <div id="admin-menu-section" class="hidden"><div class="py-3 px-1"><div class="h-px bg-slate-100 w-full mb-3 collapsed-divider hidden"></div><span class="sidebar-text text-[10px] font-bold text-slate-400 uppercase tracking-widest pl-2">ผู้ดูแลระบบ</span></div><button onclick="showPage('user-management')" class="nav-item w-full flex items-center px-3.5 py-3 rounded-xl text-slate-500 hover:bg-indigo-50 hover:text-indigo-600 transition-all duration-200 group relative"><div class="w-6 h-6 flex items-center justify-center shrink-0"><i class="fa-solid fa-users-gear text-lg"></i></div><span class="sidebar-text ml-3 font-medium text-sm whitespace-nowrap">จัดการผู้ใช้งาน</span><div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">จัดการผู้ใช้งาน</div></button></div>
      </nav>

      <div class="p-4 border-t border-slate-100 bg-white shrink-0">
        <div onclick="showPage('profile')" class="flex items-center gap-3 mb-2 px-2 py-2 overflow-hidden rounded-xl transition-colors hover:bg-slate-50 group/user cursor-pointer">
          <div class="w-9 h-9 min-w-[2.25rem] rounded-full bg-indigo-50 border border-indigo-100 flex items-center justify-center text-indigo-600 shadow-sm shrink-0 overflow-hidden relative"><img id="user-avatar-display" src="" alt="User" class="w-full h-full object-cover hidden"><i id="user-icon-display" class="fa-solid fa-user-tie text-sm"></i></div>
          <div class="sidebar-text overflow-hidden transition-opacity duration-200"><p id="user-name-display" class="text-sm font-bold text-slate-700 truncate w-32">Loading...</p><p id="user-role-display" class="text-xs text-slate-500">Staff</p></div>
        </div>
        <button onclick="logout()" class="w-full flex items-center justify-center gap-2 px-3 py-2.5 text-xs font-semibold text-red-500 bg-white border border-red-100 hover:bg-red-50 rounded-xl transition-all overflow-hidden group hover:shadow-sm"><i class="fa-solid fa-power-off text-sm shrink-0"></i><span class="sidebar-text whitespace-nowrap transition-opacity duration-200">ออกจากระบบ</span><div class="hidden md:hidden group-hover:block absolute left-[calc(100%+8px)] px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-50 collapsed-tooltip pointer-events-none shadow-xl">ออกจากระบบ</div></button>
      </div>
    </aside>

    <!-- CONTENT -->
    <main class="flex-1 flex flex-col min-w-0 bg-slate-50/50 relative transition-all duration-300">
      <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 p-4 flex items-center justify-between md:hidden sticky top-0 z-20">
        <div class="flex items-center gap-3"><button onclick="toggleSidebar()" class="text-slate-500 hover:text-indigo-600 transition"><i class="fa-solid fa-bars text-xl"></i></button><span class="font-bold text-lg text-slate-700">PEA Mech</span></div>
      </header>

      <div id="page-content" class="flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth">
        
        <!-- [MODERN DASHBOARD] -->
        <div id="dashboard-page" class="page-section">
           <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
            <div>
                <h2 class="text-2xl font-bold text-slate-800">ภาพรวมระบบ</h2>
                <p class="text-slate-500 text-sm mt-1" id="dash-subtitle">สรุปสถานะการดำเนินงานซ่อมบำรุง</p>
            </div>
            
            <!-- Dashboard Filters -->
            <div class="flex flex-wrap gap-2 items-center">
                 <span class="text-xs font-bold text-slate-500 uppercase">เลือกช่วงเวลา:</span>
                 <div class="relative">
                    <select id="dash-filter-year" onchange="renderDashboardWithFilter()" class="w-24 bg-white border border-slate-200 text-slate-700 text-sm rounded-lg block p-2 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 appearance-none cursor-pointer font-num">
                        <!-- JS populated -->
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-[10px]"></i></div>
                 </div>
                 <div class="relative">
                    <select id="dash-filter-month" onchange="renderDashboardWithFilter()" class="w-32 bg-white border border-slate-200 text-slate-700 text-sm rounded-lg block p-2 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 appearance-none cursor-pointer">
                      <!-- JS populated -->
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-[10px]"></i></div>
                 </div>

                 <button onclick="refreshData()" class="px-3 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition shadow-sm" title="โหลดข้อมูลใหม่">
                    <i class="fa-solid fa-sync"></i>
                 </button>
            </div>
          </div>

          <!-- Cards -->
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8">
            <div class="bg-gradient-to-br from-indigo-500 to-indigo-600 p-6 rounded-2xl shadow-lg text-white relative overflow-hidden group hover:shadow-xl transition-all">
                <div class="relative z-10">
                    <p class="text-indigo-100 text-xs font-bold uppercase tracking-wider mb-1">งานรับเข้า (ตามช่วงเวลา)</p>
                    <h3 class="text-4xl font-bold font-num" id="stat-total">0</h3>
                </div>
                <div class="absolute right-4 top-4 w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-white/80 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-folder-open"></i></div>
            </div>
            
            <div class="bg-gradient-to-br from-emerald-500 to-emerald-600 p-6 rounded-2xl shadow-lg text-white relative overflow-hidden group hover:shadow-xl transition-all">
                 <div class="relative z-10">
                    <p class="text-emerald-100 text-xs font-bold uppercase tracking-wider mb-1">งานเสร็จสิ้น (ตามช่วงเวลา)</p>
                    <h3 class="text-4xl font-bold font-num" id="stat-closed">0</h3>
                </div>
                 <div class="absolute right-4 top-4 w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-white/80 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-circle-check"></i></div>
            </div>

            <div class="bg-gradient-to-br from-orange-400 to-orange-500 p-6 rounded-2xl shadow-lg text-white relative overflow-hidden group hover:shadow-xl transition-all">
                 <div class="relative z-10">
                    <p class="text-orange-100 text-xs font-bold uppercase tracking-wider mb-1">งานค้าง (ยอดปัจจุบันทั้งหมด)</p>
                    <h3 class="text-4xl font-bold font-num" id="stat-pending-total">0</h3>
                </div>
                 <div class="absolute right-4 top-4 w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-white/80 text-2xl group-hover:scale-110 transition-transform"><i class="fa-solid fa-clock"></i></div>
            </div>
          </div>

          <!-- Charts -->
          <div id="dashboard-chart-section" class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8 hidden">
             <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm lg:col-span-2">
                 <h4 class="text-sm font-bold text-slate-700 mb-4"><i class="fa-solid fa-chart-column text-indigo-500 mr-2"></i>ปริมาณงานแยกตามแผนก</h4>
                 <div class="h-64"><canvas id="deptChart"></canvas></div>
             </div>
             <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm">
                 <h4 class="text-sm font-bold text-slate-700 mb-4"><i class="fa-solid fa-chart-pie text-orange-500 mr-2"></i>สัดส่วนอายุงานค้าง</h4>
                 <div class="h-64"><canvas id="agingChart"></canvas></div>
             </div>
          </div>

          <!-- Matrix Table -->
          <div class="bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden">
             <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center">
                 <h3 class="font-bold text-slate-700 flex items-center gap-2"><i class="fa-solid fa-table-list text-indigo-500"></i> รายละเอียดสถานะงาน</h3>
                 <span class="text-xs text-slate-400 font-num" id="last-update-time"></span>
             </div>
             <div class="overflow-x-auto">
                 <table class="w-full text-sm text-left">
                     <thead>
                         <tr class="bg-slate-50/80 text-slate-600 border-b border-slate-200 uppercase text-[10px] tracking-wider">
                             <th class="p-3 font-bold w-1/6 pl-6">แผนก</th>
                             <th class="p-3 text-center font-bold text-indigo-700 bg-indigo-50/50">งานเข้า<br><span class="text-[9px] font-normal text-slate-400">(ตามช่วงเวลา)</span></th>
                             <th class="p-3 text-center font-bold text-emerald-700 bg-emerald-50/50">งานเสร็จ<br><span class="text-[9px] font-normal text-slate-400">(ตามช่วงเวลา)</span></th>
                             <th class="p-3 text-center border-l border-slate-200"><span class="text-green-600"><= 3 ด.</span></th>
                             <th class="p-3 text-center"><span class="text-yellow-600">3-6 ด.</span></th>
                             <th class="p-3 text-center"><span class="text-orange-600">6-12 ด.</span></th>
                             <th class="p-3 text-center"><span class="text-red-600">> 1 ปี</span></th>
                             <th class="p-3 text-center font-bold text-orange-700 bg-orange-50/50 border-l border-slate-200">รวมค้าง<br><span class="text-[9px] font-normal text-slate-400">(ปัจจุบัน)</span></th>
                         </tr>
                     </thead>
                     <tbody id="dashboard-matrix-body" class="divide-y divide-slate-100 font-num text-slate-600"></tbody>
                 </table>
             </div>
          </div>
        </div>

        <!-- JOB LIST PAGE -->
        <div id="job-list-page" class="page-section hidden">
          <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
            <div>
              <div class="flex items-center gap-3"><h2 id="job-page-title" class="text-2xl font-bold text-slate-800">รายการงาน</h2><span id="job-count-display" class="bg-indigo-100 text-indigo-700 text-xs font-bold px-2.5 py-1 rounded-full border border-indigo-200 shadow-sm">0 รายการ</span></div><p class="text-slate-500 text-sm mt-1">ข้อมูลงานซ่อมบำรุงและสถานะปัจจุบัน</p>
            </div>
            <div class="flex gap-3 w-full md:w-auto items-center"><div class="relative w-full md:w-64 group"><span class="absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400"><i class="fa-solid fa-search"></i></span><input type="text" id="search-input" onkeyup="applyFilters()" placeholder="ค้นหา..." class="w-full pl-10 pr-4 py-2 bg-white border border-slate-200 rounded-lg outline-none text-sm shadow-sm transition"></div><button onclick="openCreateJobModal()" id="btn-create-job" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg shadow-md hidden flex items-center gap-2 text-sm font-medium"><i class="fa-solid fa-plus"></i> <span class="hidden sm:inline">เพิ่มงานใหม่</span></button></div>
          </div>
          <div id="dept-filter-container" class="hidden mb-4 overflow-x-auto pb-1 scrollbar-hide"><div class="flex space-x-2"><button onclick="setDeptFilter('ผซก.1')" class="dept-filter-btn px-4 py-1.5 rounded-full text-xs font-medium border bg-white text-slate-600" data-dept="ผซก.1">ผซก.1</button><button onclick="setDeptFilter('ผซก.2')" class="dept-filter-btn px-4 py-1.5 rounded-full text-xs font-medium border bg-white text-slate-600" data-dept="ผซก.2">ผซก.2</button><button onclick="setDeptFilter('ผทค.')" class="dept-filter-btn px-4 py-1.5 rounded-full text-xs font-medium border bg-white text-slate-600" data-dept="ผทค.">ผทค.</button><button onclick="setDeptFilter('ผซค.')" class="dept-filter-btn px-4 py-1.5 rounded-full text-xs font-medium border bg-white text-slate-600" data-dept="ผซค.">ผซค.</button><button onclick="setDeptFilter('ผพจ.')" class="dept-filter-btn px-4 py-1.5 rounded-full text-xs font-medium border bg-white text-slate-600" data-dept="ผพจ.">ผพจ.</button><button onclick="setDeptFilter('ผจส.')" class="dept-filter-btn px-4 py-1.5 rounded-full text-xs font-medium border bg-white text-slate-600" data-dept="ผจส.">ผจส.</button></div></div>
          
          <div id="active-job-scorecards" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6 hidden animate-fade-in"></div>
          
          <div id="filter-panel" class="hidden bg-white p-4 rounded-xl border border-slate-200 shadow-sm mb-6 flex-wrap gap-4 items-end animate-fade-in">
            <div id="filter-month-wrapper" class="w-full md:w-auto hidden"><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1">เดือนที่ปิดงาน</label><div class="relative"><select id="filter-month" onchange="applyFilters()" class="w-full md:w-32 bg-slate-50 border border-slate-200 text-slate-700 text-sm rounded-lg block p-2.5 appearance-none cursor-pointer"><option value="all">ทุกเดือน</option><option value="1">มกราคม</option><option value="2">กุมภาพันธ์</option><option value="3">มีนาคม</option><option value="4">เมษายน</option><option value="5">พฤษภาคม</option><option value="6">มิถุนายน</option><option value="7">กรกฎาคม</option><option value="8">สิงหาคม</option><option value="9">กันยายน</option><option value="10">ตุลาคม</option><option value="11">พฤศจิกายน</option><option value="12">ธันวาคม</option></select><div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-xs"></i></div></div></div>
            <div id="filter-year-wrapper" class="w-full md:w-auto hidden"><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5 ml-1">ปีงบประมาณ</label><div class="relative"><select id="filter-year" onchange="applyFilters()" class="w-full md:w-32 bg-slate-50 border border-slate-200 text-slate-700 text-sm rounded-lg block p-2.5 appearance-none cursor-pointer"><option value="all">ทั้งหมด</option></select><div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-xs"></i></div></div></div>
            <button onclick="resetFilters()" class="text-slate-400 hover:text-indigo-600 text-sm font-medium px-2 transition flex items-center gap-1 pb-2"><i class="fa-solid fa-rotate-left"></i> รีเซ็ต</button>
          </div>

          <div id="job-table-container" class="bg-white rounded-xl shadow-soft border border-slate-200 overflow-hidden relative">
            <div class="overflow-x-auto">
              <table class="w-full text-left text-sm text-slate-600 whitespace-nowrap modern-table">
                <thead>
                  <tr class="bg-slate-50 border-b border-slate-200 text-xs uppercase tracking-wider font-semibold text-slate-500 cursor-pointer select-none">
                    <th class="p-4 pl-6 sticky-col" onclick="sortJobs('id')">เลขงาน <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4 min-w-[300px]" onclick="sortJobs('desc')">รายละเอียด <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th id="th-jobtype" class="p-4 hidden" onclick="sortJobs('jobType')">ประเภทงาน <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th id="th-pending-type" class="p-4" onclick="sortJobs('pendingType')">ประเภทงานค้าง <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th id="th-pending-desc" class="p-4 min-w-[200px]" onclick="sortJobs('pendingDesc')">รายละเอียดงานค้าง <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4" onclick="sortJobs('date')">รับงาน <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4 text-center" onclick="sortJobs('duration')">ระยะเวลา <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4" onclick="sortJobs('sender')">ผู้ส่ง <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4" onclick="sortJobs('responsible')">ผู้รับผิดชอบ <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4 text-center" onclick="sortJobs('status')">สถานะ <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th id="th-approver" class="p-4 hidden" onclick="sortJobs('approver')">ผู้อนุมัติ <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th id="th-closedate" class="p-4 hidden" onclick="sortJobs('closeDate')">ปิดงาน <i class="fa-solid fa-sort ml-1 text-slate-300"></i></th>
                    <th class="p-4 text-center"></th>
                  </tr>
                </thead>
                <tbody id="job-table-body" class="divide-y divide-slate-100"></tbody>
              </table>
            </div>
          </div>
          
          <div id="job-ticket-container" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in"></div>
          <div id="loading-table" class="py-12 text-center hidden"><div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-100 border-t-indigo-600 mb-2"></div><p class="text-slate-400 text-sm">กำลังโหลดข้อมูล...</p></div>
        </div>

        <!-- USER & PROFILE -->
        <div id="user-management-page" class="page-section hidden"><div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4"><div><h2 class="text-2xl font-bold text-slate-800">จัดการผู้ใช้งาน</h2><p class="text-slate-500 text-sm mt-1">รายชื่อพนักงานและสิทธิ์การเข้าใช้งานระบบ</p></div><button onclick="refreshUsers()" class="group flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-lg text-sm text-slate-600 hover:border-indigo-500 hover:text-indigo-600 transition shadow-sm"><i class="fa-solid fa-sync group-hover:rotate-180 transition-transform duration-500"></i> อัปเดตข้อมูล</button></div><div class="bg-white rounded-xl shadow-soft border border-slate-200 overflow-hidden relative"><div class="overflow-x-auto"><table class="w-full text-left text-sm text-slate-600 whitespace-nowrap modern-table"><thead><tr class="bg-slate-50 border-b border-slate-200 text-xs uppercase tracking-wider font-semibold text-slate-500"><th class="p-4 pl-6">รูปภาพ</th><th class="p-4">รหัสพนักงาน</th><th class="p-4">ชื่อ-นามสกุล</th><th class="p-4">แผนก</th><th class="p-4">ตำแหน่ง</th><th class="p-4 text-center">สิทธิ์ (Level)</th><th class="p-4 text-center">จัดการ</th></tr></thead><tbody id="user-table-body" class="divide-y divide-slate-100"></tbody></table></div><div id="loading-users" class="py-12 text-center hidden"><div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-indigo-100 border-t-indigo-600 mb-2"></div><p class="text-slate-400 text-sm">กำลังโหลดรายชื่อ...</p></div></div></div>
        <div id="profile-page" class="page-section hidden"><div class="flex justify-between items-start mb-6"><div><h2 class="text-2xl font-bold text-slate-800">โปรไฟล์ส่วนตัว</h2><p class="text-slate-500 text-sm mt-1">ข้อมูลผู้ใช้งานและงานที่รับผิดชอบ</p></div><button onclick="openProfileEditModal()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-md flex items-center gap-2"><i class="fa-solid fa-pen-to-square"></i> แก้ไขข้อมูล</button></div><div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm mb-8 flex flex-col md:flex-row items-center md:items-start gap-6"><div class="w-24 h-24 rounded-full bg-slate-100 border-4 border-white shadow-lg overflow-hidden shrink-0 relative"><img id="profile-avatar-display" src="" class="w-full h-full object-cover hidden"><div id="profile-icon-display" class="w-full h-full flex items-center justify-center text-slate-400 text-4xl"><i class="fa-solid fa-user"></i></div></div><div class="flex-1 text-center md:text-left space-y-2"><h3 class="text-xl font-bold text-slate-800" id="profile-name">-</h3><div class="flex flex-wrap justify-center md:justify-start gap-3"><span class="bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold border border-indigo-100" id="profile-role">Staff</span><span class="bg-slate-100 text-slate-600 px-3 py-1 rounded-full text-xs font-medium border border-slate-200" id="profile-dept">-</span></div><div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 mt-4 text-sm text-slate-600"><div class="flex items-center gap-2"><i class="fa-solid fa-id-badge text-slate-400 w-5"></i> <span id="profile-id">-</span></div><div class="flex items-center gap-2"><i class="fa-solid fa-briefcase text-slate-400 w-5"></i> <span id="profile-pos">-</span></div></div></div></div><div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"><div class="flex border-b border-slate-200 bg-slate-50/50"><button onclick="switchMyJobsTab('active')" class="my-job-tab active flex-1 py-4 text-sm font-semibold border-b-2 border-indigo-600 text-indigo-600 bg-white">งานที่กำลังดำเนินการ</button><button onclick="switchMyJobsTab('closed')" class="my-job-tab flex-1 py-4 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-indigo-600">งานเสร็จสิ้น</button><button onclick="switchMyJobsTab('cancelled')" class="my-job-tab flex-1 py-4 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-indigo-600">งานยกเลิก</button></div><div class="p-0"><div id="my-jobs-list" class="divide-y divide-slate-100"><div class="p-8 text-center text-slate-400">กำลังโหลดข้อมูล...</div></div></div></div></div>
      </div>
    </main>
  </div>
  
  <!-- MODALS -->
  <div id="create-job-modal" class="fixed inset-0 z-50 hidden bg-slate-900/60 flex items-center justify-center p-4 backdrop-blur-sm"><div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden transform scale-95 opacity-0 transition-all duration-300"><div class="bg-gradient-to-r from-indigo-600 to-indigo-700 p-5 flex justify-between items-center text-white"><div class="flex items-center gap-2"><div class="p-1.5 bg-white/20 rounded-lg"><i class="fa-solid fa-file-circle-plus"></i></div><h3 class="font-bold text-lg">สร้างงานใหม่</h3></div><button onclick="closeModal('create-job-modal')" class="hover:text-indigo-200"><i class="fa-solid fa-times text-lg"></i></button></div><form id="create-job-form" onsubmit="submitNewJob(event)" class="p-6 space-y-5"><div class="grid grid-cols-2 gap-5"><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">แผนกผู้รับผิดชอบ</label><div class="relative"><select name="แผนกเจ้าของเรื่อง" class="w-full border border-slate-200 rounded-lg p-2.5 bg-slate-50 text-sm" required><option value="">เลือกแผนก</option><option value="ผซก.1">ผซก.1</option><option value="ผซก.2">ผซก.2</option><option value="ผทค.">ผทค.</option><option value="ผซค.">ผซค.</option><option value="ผพจ.">ผพจ.</option><option value="ผจส.">ผจส.</option></select><div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-xs"></i></div></div></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">หน่วยงานผู้ส่ง</label><input type="text" name="ผู้ส่งงาน" class="w-full border border-slate-200 rounded-lg p-2.5 bg-slate-50 text-sm" required></div></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">รายละเอียดงาน</label><textarea name="รายละเอียดงาน" rows="3" class="w-full border border-slate-200 rounded-lg p-2.5 bg-slate-50 text-sm resize-none" required></textarea></div><div class="flex justify-end pt-2 gap-3"><button type="button" onclick="closeModal('create-job-modal')" class="px-5 py-2.5 text-slate-600 hover:bg-slate-100 rounded-lg text-sm font-medium">ยกเลิก</button><button type="submit" class="px-5 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 shadow-lg shadow-indigo-200 text-sm font-medium"><span>บันทึกข้อมูล</span><i id="create-spinner" class="fa-solid fa-circle-notch fa-spin ml-2 hidden"></i></button></div></form></div></div>
  <div id="job-detail-modal" class="fixed inset-0 z-50 hidden bg-slate-900/60 flex items-center justify-center p-4 backdrop-blur-sm"><div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[90vh] flex flex-col overflow-hidden transform scale-95 opacity-0 transition-all duration-300"><div class="bg-white border-b border-slate-100 p-5 flex justify-between items-center sticky top-0 z-10"><div><div class="flex items-center gap-3"><h3 class="font-bold text-xl text-slate-800 font-num" id="detail-job-id">Loading...</h3><span id="detail-job-status" class="text-[10px] px-2.5 py-1 rounded-full bg-slate-100 text-slate-500 font-bold uppercase tracking-wider border border-slate-200">Loading...</span></div><p class="text-xs text-slate-400 mt-1">รายละเอียดงานซ่อมบำรุงและประวัติการดำเนินงาน</p></div><button onclick="closeModal('job-detail-modal')" class="w-8 h-8 rounded-full bg-slate-50 text-slate-400 hover:bg-red-50 hover:text-red-500 flex items-center justify-center transition"><i class="fa-solid fa-times"></i></button></div><div class="flex border-b border-slate-100 bg-slate-50/50 px-4 pt-2"><button onclick="switchTab('tab-info')" class="tab-btn active px-4 py-3 text-sm font-semibold border-b-2 border-indigo-600 text-indigo-600 bg-transparent transition">รายละเอียด</button><button onclick="switchTab('tab-ops')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-indigo-600 transition">การปฏิบัติงาน</button><button onclick="switchTab('tab-parts')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-indigo-600 transition">เบิกอะไหล่</button></div><div class="flex-1 overflow-y-auto p-6 bg-slate-50/50"><div id="tab-info" class="tab-content block space-y-6"><div class="bg-white p-6 rounded-xl shadow-soft border border-slate-100"><h4 class="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2"><i class="fa-regular fa-clipboard text-indigo-500"></i> ข้อมูลทั่วไป</h4><div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm"><div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><span class="text-xs font-bold text-slate-400 uppercase block mb-1">แผนกรับผิดชอบ</span><span id="view-dept" class="font-medium text-slate-800 text-base">-</span></div><div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><span class="text-xs font-bold text-slate-400 uppercase block mb-1">หน่วยงานผู้ส่ง</span><span id="view-sender" class="font-medium text-slate-800 text-base">-</span></div><div class="bg-slate-50 p-3 rounded-lg border border-slate-100"><span class="text-xs font-bold text-slate-400 uppercase block mb-1">วันที่รับงาน</span><span id="view-date" class="font-medium text-slate-800 text-base">-</span></div><div class="md:col-span-3 bg-slate-50 p-4 rounded-lg border border-slate-100"><span class="text-xs font-bold text-slate-400 uppercase block mb-2">รายละเอียดงาน</span><div id="view-desc" class="font-medium text-slate-800 text-base leading-relaxed min-h-[60px]">-</div></div></div></div><div id="action-area" class="bg-white p-6 rounded-xl shadow-soft border border-slate-100 hidden"><h4 class="text-sm font-bold text-slate-700 mb-4 flex items-center gap-2"><i class="fa-solid fa-sliders text-indigo-500"></i> การดำเนินการ</h4><div class="flex flex-wrap gap-3"><button onclick="requestCloseJob()" class="btn-staff-only bg-green-600 text-white px-5 py-2.5 rounded-lg shadow hover:bg-green-700 transition font-medium hidden flex items-center gap-2"><i class="fa-solid fa-check"></i> ขอปิดงาน</button><button onclick="approveJob()" class="btn-approver-only bg-indigo-600 text-white px-5 py-2.5 rounded-lg shadow hover:bg-indigo-700 transition font-medium hidden flex items-center gap-2"><i class="fa-solid fa-thumbs-up"></i> อนุมัติปิดงาน</button></div></div></div><div id="tab-ops" class="tab-content hidden space-y-4"><div class="flex justify-between items-center mb-2"><h4 class="font-bold text-slate-700">บันทึกการปฏิบัติงาน</h4><button onclick="addLog()" class="text-xs bg-white border border-indigo-200 text-indigo-600 px-3 py-1.5 rounded-lg hover:bg-indigo-50 transition font-medium shadow-sm"><i class="fa-solid fa-plus mr-1"></i> เพิ่มบันทึก</button></div><div id="ops-list" class="space-y-3"></div></div><div id="tab-parts" class="tab-content hidden space-y-4"><div class="flex justify-between items-center mb-2"><h4 class="font-bold text-slate-700">รายการเบิกอะไหล่</h4><button onclick="addPart()" class="text-xs bg-white border border-indigo-200 text-indigo-600 px-3 py-1.5 rounded-lg hover:bg-indigo-50 transition font-medium shadow-sm"><i class="fa-solid fa-plus mr-1"></i> เบิกอะไหล่</button></div><div class="bg-white rounded-xl shadow-soft border border-slate-200 overflow-hidden"><table class="w-full text-sm modern-table"><thead><tr><th class="p-3 pl-5 text-left">รายการ</th><th class="p-3 text-center">จำนวน</th><th class="p-3 text-right">ราคา</th><th class="p-3 text-center">วันที่</th></tr></thead><tbody id="parts-table-body" class="divide-y divide-slate-100"></tbody></table></div></div></div></div></div>
  <div id="edit-user-modal" class="fixed inset-0 z-50 hidden bg-slate-900/60 flex items-center justify-center p-4 backdrop-blur-sm"><div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden transform scale-95 opacity-0 transition-all duration-300"><div class="bg-slate-800 p-5 flex justify-between items-center text-white"><h3 class="font-bold text-lg flex items-center gap-2"><i class="fa-solid fa-user-gear"></i> แก้ไขข้อมูลผู้ใช้งาน</h3><button onclick="closeModal('edit-user-modal')" class="hover:text-slate-300"><i class="fa-solid fa-times text-lg"></i></button></div><form id="edit-user-form" onsubmit="submitEditUser(event)" class="p-6 space-y-5"><input type="hidden" id="edit-user-id-hidden"><div class="flex flex-col items-center justify-center mb-4"><div class="w-24 h-24 rounded-full bg-slate-100 border-4 border-slate-200 overflow-hidden relative group cursor-pointer" onclick="document.getElementById('admin-user-image-upload').click()"><img id="edit-user-preview" src="" class="w-full h-full object-cover hidden"><div id="edit-user-icon" class="w-full h-full flex items-center justify-center text-slate-400 text-3xl"><i class="fa-solid fa-camera"></i></div><div class="absolute inset-0 bg-black/40 hidden group-hover:flex items-center justify-center text-white text-xs font-medium">เปลี่ยนรูป</div></div><input type="file" id="admin-user-image-upload" class="hidden" accept="image/*" onchange="handleImagePreview(this, 'edit-user')"><p class="text-xs text-slate-400 mt-2">คลิกที่รูปเพื่อเปลี่ยน</p></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">รหัสพนักงาน</label><input type="text" id="edit-user-id" class="w-full border border-slate-200 rounded-lg p-2.5 bg-slate-100 text-slate-500 text-sm font-bold" disabled></div><div class="grid grid-cols-2 gap-5"><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">ชื่อ-นามสกุล</label><input type="text" id="edit-user-name" class="w-full border border-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-sm" required></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">รหัสผ่าน</label><input type="text" id="edit-user-pass" class="w-full border border-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-sm" placeholder="เว้นว่างหากไม่แก้"></div></div><div class="grid grid-cols-2 gap-5"><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">สิทธิ์การใช้งาน (Level)</label><div class="relative"><select id="edit-user-role" class="w-full border border-slate-200 rounded-lg p-2.5 bg-white text-sm focus:ring-2 focus:ring-indigo-500 appearance-none"><option value="User">User</option><option value="Manager">Manager</option><option value="Admin">Admin</option></select><div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-xs"></i></div></div></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">แผนก</label><div class="relative"><select id="edit-user-dept" class="w-full border border-slate-200 rounded-lg p-2.5 bg-white text-sm focus:ring-2 focus:ring-indigo-500 appearance-none"><option value="ผซก.1">ผซก.1</option><option value="ผซก.2">ผซก.2</option><option value="ผทค.">ผทค.</option><option value="ผซค.">ผซค.</option><option value="ผพจ.">ผพจ.</option><option value="ผจส.">ผจส.</option></select><div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-500"><i class="fa-solid fa-chevron-down text-xs"></i></div></div></div></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">ตำแหน่ง</label><input type="text" id="edit-user-pos" class="w-full border border-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-sm"></div><div class="flex justify-end pt-4 gap-3"><button type="button" onclick="closeModal('edit-user-modal')" class="px-5 py-2.5 text-slate-600 hover:bg-slate-100 rounded-lg text-sm font-medium">ยกเลิก</button><button type="submit" class="px-5 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 shadow-md text-sm font-medium flex items-center"><span>บันทึกการแก้ไข</span><i id="edit-user-spinner" class="fa-solid fa-circle-notch fa-spin ml-2 hidden"></i></button></div></form></div></div>
  <div id="edit-profile-modal" class="fixed inset-0 z-50 hidden bg-slate-900/60 flex items-center justify-center p-4 backdrop-blur-sm"><div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden transform scale-95 opacity-0 transition-all duration-300"><div class="bg-indigo-600 p-5 flex justify-between items-center text-white"><h3 class="font-bold text-lg flex items-center gap-2"><i class="fa-solid fa-id-card"></i> แก้ไขข้อมูลส่วนตัว</h3><button onclick="closeModal('edit-profile-modal')" class="hover:text-indigo-200"><i class="fa-solid fa-times text-lg"></i></button></div><form id="edit-profile-form" onsubmit="submitEditProfile(event)" class="p-6 space-y-5"><div class="flex flex-col items-center justify-center mb-4"><div class="w-24 h-24 rounded-full bg-slate-100 border-4 border-indigo-50 overflow-hidden relative group cursor-pointer" onclick="document.getElementById('profile-image-upload').click()"><img id="edit-profile-preview" src="" class="w-full h-full object-cover hidden"><div id="edit-profile-icon" class="w-full h-full flex items-center justify-center text-slate-400 text-3xl"><i class="fa-solid fa-camera"></i></div><div class="absolute inset-0 bg-black/40 hidden group-hover:flex items-center justify-center text-white text-xs font-medium">เปลี่ยนรูป</div></div><input type="file" id="profile-image-upload" class="hidden" accept="image/*" onchange="handleImagePreview(this, 'edit-profile')"><p class="text-xs text-slate-400 mt-2">คลิกที่รูปเพื่อเปลี่ยน</p></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">รหัสพนักงาน</label><input type="text" id="ep-id" class="w-full border border-slate-200 rounded-lg p-2.5 bg-slate-100 text-slate-500 text-sm font-bold" disabled></div><div class="grid grid-cols-2 gap-5"><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">ชื่อ-นามสกุล</label><input type="text" id="ep-name" class="w-full border border-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-sm" required></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">รหัสผ่านใหม่</label><input type="text" id="ep-pass" class="w-full border border-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-sm" placeholder="เว้นว่างหากไม่แก้"></div></div><div class="grid grid-cols-2 gap-5"><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">แผนก</label><input type="text" id="ep-dept" class="w-full border border-slate-200 rounded-lg p-2.5 bg-slate-100 text-slate-500 text-sm" disabled></div><div><label class="block text-xs font-bold text-slate-500 uppercase mb-1.5">ตำแหน่ง</label><input type="text" id="ep-pos" class="w-full border border-slate-200 rounded-lg p-2.5 focus:ring-2 focus:ring-indigo-500 outline-none text-sm"></div></div><div class="flex justify-end pt-4 gap-3"><button type="button" onclick="closeModal('edit-profile-modal')" class="px-5 py-2.5 text-slate-600 hover:bg-slate-100 rounded-lg text-sm font-medium">ยกเลิก</button><button type="submit" class="px-5 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 shadow-md text-sm font-medium flex items-center"><span>บันทึก</span><i id="ep-spinner" class="fa-solid fa-circle-notch fa-spin ml-2 hidden"></i></button></div></form></div></div>

  <?!= include('js'); ?>
</body>
</html>